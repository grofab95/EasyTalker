-- dbo.ConversationInfosView source

CREATE VIEW [dbo].[ConversationInfosView]
AS
with ConversationInfos as (
      select uc.ConversationId ,STRING_AGG(uc.UserId + ':' + str(uc.HasAccess), '|') as ConversationParticipants 
      from UsersConversations uc 
      group by uc.ConversationId 
)

select
      c.Id as ConversationId, 
      c.Title, 
      c.CreatorId,
      (select ConversationParticipants from ConversationInfos where ConversationId = c.Id) as ConversationParticipantsString
from Conversations c;